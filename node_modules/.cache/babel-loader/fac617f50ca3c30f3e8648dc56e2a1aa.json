{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getElementsByTagType = exports.getElementsByTagName = exports.getElementById = exports.getElements = exports.testElement = void 0;\n\nvar domhandler_1 = require(\"domhandler\");\n\nvar querying_js_1 = require(\"./querying.js\");\n\nvar Checks = {\n  tag_name: function (name) {\n    if (typeof name === \"function\") {\n      return function (elem) {\n        return (0, domhandler_1.isTag)(elem) && name(elem.name);\n      };\n    } else if (name === \"*\") {\n      return domhandler_1.isTag;\n    }\n\n    return function (elem) {\n      return (0, domhandler_1.isTag)(elem) && elem.name === name;\n    };\n  },\n  tag_type: function (type) {\n    if (typeof type === \"function\") {\n      return function (elem) {\n        return type(elem.type);\n      };\n    }\n\n    return function (elem) {\n      return elem.type === type;\n    };\n  },\n  tag_contains: function (data) {\n    if (typeof data === \"function\") {\n      return function (elem) {\n        return (0, domhandler_1.isText)(elem) && data(elem.data);\n      };\n    }\n\n    return function (elem) {\n      return (0, domhandler_1.isText)(elem) && elem.data === data;\n    };\n  }\n};\n/**\n * @param attrib Attribute to check.\n * @param value Attribute value to look for.\n * @returns A function to check whether the a node has an attribute with a\n *   particular value.\n */\n\nfunction getAttribCheck(attrib, value) {\n  if (typeof value === \"function\") {\n    return function (elem) {\n      return (0, domhandler_1.isTag)(elem) && value(elem.attribs[attrib]);\n    };\n  }\n\n  return function (elem) {\n    return (0, domhandler_1.isTag)(elem) && elem.attribs[attrib] === value;\n  };\n}\n/**\n * @param a First function to combine.\n * @param b Second function to combine.\n * @returns A function taking a node and returning `true` if either of the input\n *   functions returns `true` for the node.\n */\n\n\nfunction combineFuncs(a, b) {\n  return function (elem) {\n    return a(elem) || b(elem);\n  };\n}\n/**\n * @param options An object describing nodes to look for.\n * @returns A function executing all checks in `options` and returning `true` if\n *   any of them match a node.\n */\n\n\nfunction compileTest(options) {\n  var funcs = Object.keys(options).map(function (key) {\n    var value = options[key];\n    return Object.prototype.hasOwnProperty.call(Checks, key) ? Checks[key](value) : getAttribCheck(key, value);\n  });\n  return funcs.length === 0 ? null : funcs.reduce(combineFuncs);\n}\n/**\n * @category Legacy Query Functions\n * @param options An object describing nodes to look for.\n * @param node The element to test.\n * @returns Whether the element matches the description in `options`.\n */\n\n\nfunction testElement(options, node) {\n  var test = compileTest(options);\n  return test ? test(node) : true;\n}\n\nexports.testElement = testElement;\n/**\n * @category Legacy Query Functions\n * @param options An object describing nodes to look for.\n * @param nodes Nodes to search through.\n * @param recurse Also consider child nodes.\n * @param limit Maximum number of nodes to return.\n * @returns All nodes that match `options`.\n */\n\nfunction getElements(options, nodes, recurse, limit) {\n  if (limit === void 0) {\n    limit = Infinity;\n  }\n\n  var test = compileTest(options);\n  return test ? (0, querying_js_1.filter)(test, nodes, recurse, limit) : [];\n}\n\nexports.getElements = getElements;\n/**\n * @category Legacy Query Functions\n * @param id The unique ID attribute value to look for.\n * @param nodes Nodes to search through.\n * @param recurse Also consider child nodes.\n * @returns The node with the supplied ID.\n */\n\nfunction getElementById(id, nodes, recurse) {\n  if (recurse === void 0) {\n    recurse = true;\n  }\n\n  if (!Array.isArray(nodes)) nodes = [nodes];\n  return (0, querying_js_1.findOne)(getAttribCheck(\"id\", id), nodes, recurse);\n}\n\nexports.getElementById = getElementById;\n/**\n * @category Legacy Query Functions\n * @param tagName Tag name to search for.\n * @param nodes Nodes to search through.\n * @param recurse Also consider child nodes.\n * @param limit Maximum number of nodes to return.\n * @returns All nodes with the supplied `tagName`.\n */\n\nfunction getElementsByTagName(tagName, nodes, recurse, limit) {\n  if (recurse === void 0) {\n    recurse = true;\n  }\n\n  if (limit === void 0) {\n    limit = Infinity;\n  }\n\n  return (0, querying_js_1.filter)(Checks[\"tag_name\"](tagName), nodes, recurse, limit);\n}\n\nexports.getElementsByTagName = getElementsByTagName;\n/**\n * @category Legacy Query Functions\n * @param type Element type to look for.\n * @param nodes Nodes to search through.\n * @param recurse Also consider child nodes.\n * @param limit Maximum number of nodes to return.\n * @returns All nodes with the supplied `type`.\n */\n\nfunction getElementsByTagType(type, nodes, recurse, limit) {\n  if (recurse === void 0) {\n    recurse = true;\n  }\n\n  if (limit === void 0) {\n    limit = Infinity;\n  }\n\n  return (0, querying_js_1.filter)(Checks[\"tag_type\"](type), nodes, recurse, limit);\n}\n\nexports.getElementsByTagType = getElementsByTagType;","map":{"version":3,"mappings":"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","names":["Checks","tag_name","name","elem","domhandler_1","tag_type","type","tag_contains","data","getAttribCheck","attrib","value","attribs","combineFuncs","a","b","compileTest","options","funcs","Object","keys","map","key","prototype","hasOwnProperty","call","length","reduce","testElement","node","test","exports","getElements","nodes","recurse","limit","getElementById","id","Array","isArray","getElementsByTagName","tagName","getElementsByTagType"],"sources":["legacy.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.filters = void 0;\n\nvar nth_check_1 = __importDefault(require(\"nth-check\"));\n\nvar boolbase_1 = __importDefault(require(\"boolbase\"));\n\nfunction getChildFunc(next, adapter) {\n  return function (elem) {\n    var parent = adapter.getParent(elem);\n    return parent != null && adapter.isTag(parent) && next(elem);\n  };\n}\n\nexports.filters = {\n  contains: function (next, text, _a) {\n    var adapter = _a.adapter;\n    return function contains(elem) {\n      return next(elem) && adapter.getText(elem).includes(text);\n    };\n  },\n  icontains: function (next, text, _a) {\n    var adapter = _a.adapter;\n    var itext = text.toLowerCase();\n    return function icontains(elem) {\n      return next(elem) && adapter.getText(elem).toLowerCase().includes(itext);\n    };\n  },\n  // Location specific methods\n  \"nth-child\": function (next, rule, _a) {\n    var adapter = _a.adapter,\n        equals = _a.equals;\n    var func = (0, nth_check_1.default)(rule);\n    if (func === boolbase_1.default.falseFunc) return boolbase_1.default.falseFunc;\n    if (func === boolbase_1.default.trueFunc) return getChildFunc(next, adapter);\n    return function nthChild(elem) {\n      var siblings = adapter.getSiblings(elem);\n      var pos = 0;\n\n      for (var i = 0; i < siblings.length; i++) {\n        if (equals(elem, siblings[i])) break;\n\n        if (adapter.isTag(siblings[i])) {\n          pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n  \"nth-last-child\": function (next, rule, _a) {\n    var adapter = _a.adapter,\n        equals = _a.equals;\n    var func = (0, nth_check_1.default)(rule);\n    if (func === boolbase_1.default.falseFunc) return boolbase_1.default.falseFunc;\n    if (func === boolbase_1.default.trueFunc) return getChildFunc(next, adapter);\n    return function nthLastChild(elem) {\n      var siblings = adapter.getSiblings(elem);\n      var pos = 0;\n\n      for (var i = siblings.length - 1; i >= 0; i--) {\n        if (equals(elem, siblings[i])) break;\n\n        if (adapter.isTag(siblings[i])) {\n          pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n  \"nth-of-type\": function (next, rule, _a) {\n    var adapter = _a.adapter,\n        equals = _a.equals;\n    var func = (0, nth_check_1.default)(rule);\n    if (func === boolbase_1.default.falseFunc) return boolbase_1.default.falseFunc;\n    if (func === boolbase_1.default.trueFunc) return getChildFunc(next, adapter);\n    return function nthOfType(elem) {\n      var siblings = adapter.getSiblings(elem);\n      var pos = 0;\n\n      for (var i = 0; i < siblings.length; i++) {\n        var currentSibling = siblings[i];\n        if (equals(elem, currentSibling)) break;\n\n        if (adapter.isTag(currentSibling) && adapter.getName(currentSibling) === adapter.getName(elem)) {\n          pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n  \"nth-last-of-type\": function (next, rule, _a) {\n    var adapter = _a.adapter,\n        equals = _a.equals;\n    var func = (0, nth_check_1.default)(rule);\n    if (func === boolbase_1.default.falseFunc) return boolbase_1.default.falseFunc;\n    if (func === boolbase_1.default.trueFunc) return getChildFunc(next, adapter);\n    return function nthLastOfType(elem) {\n      var siblings = adapter.getSiblings(elem);\n      var pos = 0;\n\n      for (var i = siblings.length - 1; i >= 0; i--) {\n        var currentSibling = siblings[i];\n        if (equals(elem, currentSibling)) break;\n\n        if (adapter.isTag(currentSibling) && adapter.getName(currentSibling) === adapter.getName(elem)) {\n          pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n  // TODO determine the actual root element\n  root: function (next, _rule, _a) {\n    var adapter = _a.adapter;\n    return function (elem) {\n      var parent = adapter.getParent(elem);\n      return (parent == null || !adapter.isTag(parent)) && next(elem);\n    };\n  },\n  scope: function (next, rule, options, context) {\n    var equals = options.equals;\n\n    if (!context || context.length === 0) {\n      // Equivalent to :root\n      return exports.filters[\"root\"](next, rule, options);\n    }\n\n    if (context.length === 1) {\n      // NOTE: can't be unpacked, as :has uses this for side-effects\n      return function (elem) {\n        return equals(context[0], elem) && next(elem);\n      };\n    }\n\n    return function (elem) {\n      return context.includes(elem) && next(elem);\n    };\n  },\n  hover: dynamicStatePseudo(\"isHovered\"),\n  visited: dynamicStatePseudo(\"isVisited\"),\n  active: dynamicStatePseudo(\"isActive\")\n};\n/**\n * Dynamic state pseudos. These depend on optional Adapter methods.\n *\n * @param name The name of the adapter method to call.\n * @returns Pseudo for the `filters` object.\n */\n\nfunction dynamicStatePseudo(name) {\n  return function dynamicPseudo(next, _rule, _a) {\n    var adapter = _a.adapter;\n    var func = adapter[name];\n\n    if (typeof func !== \"function\") {\n      return boolbase_1.default.falseFunc;\n    }\n\n    return function active(elem) {\n      return func(elem) && next(elem);\n    };\n  };\n}","map":{"version":3,"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AAUA,SAASA,YAAT,CACIC,IADJ,EAEIC,OAFJ,EAEuC;EAEnC,OAAO,UAACC,IAAD,EAAK;IACR,IAAMC,MAAM,GAAGF,OAAO,CAACG,SAAR,CAAkBF,IAAlB,CAAf;IACA,OAAOC,MAAM,IAAI,IAAV,IAAkBF,OAAO,CAACI,KAAR,CAAcF,MAAd,CAAlB,IAA2CH,IAAI,CAACE,IAAD,CAAtD;EACH,CAHD;AAIH;;AAEYI,kBAAkC;EAC3CC,QAAQ,YAACP,IAAD,EAAOQ,IAAP,EAAaC,EAAb,EAAwB;QAATR,OAAO;IAC1B,OAAO,SAASM,QAAT,CAAkBL,IAAlB,EAAsB;MACzB,OAAOF,IAAI,CAACE,IAAD,CAAJ,IAAcD,OAAO,CAACS,OAAR,CAAgBR,IAAhB,EAAsBS,QAAtB,CAA+BH,IAA/B,CAArB;IACH,CAFD;EAGH,CAL0C;EAM3CI,SAAS,YAACZ,IAAD,EAAOQ,IAAP,EAAaC,EAAb,EAAwB;QAATR,OAAO;IAC3B,IAAMY,KAAK,GAAGL,IAAI,CAACM,WAAL,EAAd;IAEA,OAAO,SAASF,SAAT,CAAmBV,IAAnB,EAAuB;MAC1B,OACIF,IAAI,CAACE,IAAD,CAAJ,IACAD,OAAO,CAACS,OAAR,CAAgBR,IAAhB,EAAsBY,WAAtB,GAAoCH,QAApC,CAA6CE,KAA7C,CAFJ;IAIH,CALD;EAMH,CAf0C;EAiB3C;EACA,aAAW,UAACb,IAAD,EAAOe,IAAP,EAAaN,EAAb,EAAgC;QAAjBR,OAAO;QAAEe,MAAM;IACrC,IAAMC,IAAI,GAAG,yBAAUF,IAAV,CAAb;IAEA,IAAIE,IAAI,KAAKC,mBAASC,SAAtB,EAAiC,OAAOD,mBAASC,SAAhB;IACjC,IAAIF,IAAI,KAAKC,mBAASE,QAAtB,EAAgC,OAAOrB,YAAY,CAACC,IAAD,EAAOC,OAAP,CAAnB;IAEhC,OAAO,SAASoB,QAAT,CAAkBnB,IAAlB,EAAsB;MACzB,IAAMoB,QAAQ,GAAGrB,OAAO,CAACsB,WAAR,CAAoBrB,IAApB,CAAjB;MACA,IAAIsB,GAAG,GAAG,CAAV;;MAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,QAAQ,CAACI,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;QACtC,IAAIT,MAAM,CAACd,IAAD,EAAOoB,QAAQ,CAACG,CAAD,CAAf,CAAV,EAA+B;;QAC/B,IAAIxB,OAAO,CAACI,KAAR,CAAciB,QAAQ,CAACG,CAAD,CAAtB,CAAJ,EAAgC;UAC5BD,GAAG;QACN;MACJ;;MAED,OAAOP,IAAI,CAACO,GAAD,CAAJ,IAAaxB,IAAI,CAACE,IAAD,CAAxB;IACH,CAZD;EAaH,CArC0C;EAsC3C,kBAAgB,UAACF,IAAD,EAAOe,IAAP,EAAaN,EAAb,EAAgC;QAAjBR,OAAO;QAAEe,MAAM;IAC1C,IAAMC,IAAI,GAAG,yBAAUF,IAAV,CAAb;IAEA,IAAIE,IAAI,KAAKC,mBAASC,SAAtB,EAAiC,OAAOD,mBAASC,SAAhB;IACjC,IAAIF,IAAI,KAAKC,mBAASE,QAAtB,EAAgC,OAAOrB,YAAY,CAACC,IAAD,EAAOC,OAAP,CAAnB;IAEhC,OAAO,SAAS0B,YAAT,CAAsBzB,IAAtB,EAA0B;MAC7B,IAAMoB,QAAQ,GAAGrB,OAAO,CAACsB,WAAR,CAAoBrB,IAApB,CAAjB;MACA,IAAIsB,GAAG,GAAG,CAAV;;MAEA,KAAK,IAAIC,CAAC,GAAGH,QAAQ,CAACI,MAAT,GAAkB,CAA/B,EAAkCD,CAAC,IAAI,CAAvC,EAA0CA,CAAC,EAA3C,EAA+C;QAC3C,IAAIT,MAAM,CAACd,IAAD,EAAOoB,QAAQ,CAACG,CAAD,CAAf,CAAV,EAA+B;;QAC/B,IAAIxB,OAAO,CAACI,KAAR,CAAciB,QAAQ,CAACG,CAAD,CAAtB,CAAJ,EAAgC;UAC5BD,GAAG;QACN;MACJ;;MAED,OAAOP,IAAI,CAACO,GAAD,CAAJ,IAAaxB,IAAI,CAACE,IAAD,CAAxB;IACH,CAZD;EAaH,CAzD0C;EA0D3C,eAAa,UAACF,IAAD,EAAOe,IAAP,EAAaN,EAAb,EAAgC;QAAjBR,OAAO;QAAEe,MAAM;IACvC,IAAMC,IAAI,GAAG,yBAAUF,IAAV,CAAb;IAEA,IAAIE,IAAI,KAAKC,mBAASC,SAAtB,EAAiC,OAAOD,mBAASC,SAAhB;IACjC,IAAIF,IAAI,KAAKC,mBAASE,QAAtB,EAAgC,OAAOrB,YAAY,CAACC,IAAD,EAAOC,OAAP,CAAnB;IAEhC,OAAO,SAAS2B,SAAT,CAAmB1B,IAAnB,EAAuB;MAC1B,IAAMoB,QAAQ,GAAGrB,OAAO,CAACsB,WAAR,CAAoBrB,IAApB,CAAjB;MACA,IAAIsB,GAAG,GAAG,CAAV;;MAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,QAAQ,CAACI,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;QACtC,IAAMI,cAAc,GAAGP,QAAQ,CAACG,CAAD,CAA/B;QACA,IAAIT,MAAM,CAACd,IAAD,EAAO2B,cAAP,CAAV,EAAkC;;QAClC,IACI5B,OAAO,CAACI,KAAR,CAAcwB,cAAd,KACA5B,OAAO,CAAC6B,OAAR,CAAgBD,cAAhB,MAAoC5B,OAAO,CAAC6B,OAAR,CAAgB5B,IAAhB,CAFxC,EAGE;UACEsB,GAAG;QACN;MACJ;;MAED,OAAOP,IAAI,CAACO,GAAD,CAAJ,IAAaxB,IAAI,CAACE,IAAD,CAAxB;IACH,CAhBD;EAiBH,CAjF0C;EAkF3C,oBAAkB,UAACF,IAAD,EAAOe,IAAP,EAAaN,EAAb,EAAgC;QAAjBR,OAAO;QAAEe,MAAM;IAC5C,IAAMC,IAAI,GAAG,yBAAUF,IAAV,CAAb;IAEA,IAAIE,IAAI,KAAKC,mBAASC,SAAtB,EAAiC,OAAOD,mBAASC,SAAhB;IACjC,IAAIF,IAAI,KAAKC,mBAASE,QAAtB,EAAgC,OAAOrB,YAAY,CAACC,IAAD,EAAOC,OAAP,CAAnB;IAEhC,OAAO,SAAS8B,aAAT,CAAuB7B,IAAvB,EAA2B;MAC9B,IAAMoB,QAAQ,GAAGrB,OAAO,CAACsB,WAAR,CAAoBrB,IAApB,CAAjB;MACA,IAAIsB,GAAG,GAAG,CAAV;;MAEA,KAAK,IAAIC,CAAC,GAAGH,QAAQ,CAACI,MAAT,GAAkB,CAA/B,EAAkCD,CAAC,IAAI,CAAvC,EAA0CA,CAAC,EAA3C,EAA+C;QAC3C,IAAMI,cAAc,GAAGP,QAAQ,CAACG,CAAD,CAA/B;QACA,IAAIT,MAAM,CAACd,IAAD,EAAO2B,cAAP,CAAV,EAAkC;;QAClC,IACI5B,OAAO,CAACI,KAAR,CAAcwB,cAAd,KACA5B,OAAO,CAAC6B,OAAR,CAAgBD,cAAhB,MAAoC5B,OAAO,CAAC6B,OAAR,CAAgB5B,IAAhB,CAFxC,EAGE;UACEsB,GAAG;QACN;MACJ;;MAED,OAAOP,IAAI,CAACO,GAAD,CAAJ,IAAaxB,IAAI,CAACE,IAAD,CAAxB;IACH,CAhBD;EAiBH,CAzG0C;EA2G3C;EACA8B,IAAI,YAAChC,IAAD,EAAOiC,KAAP,EAAcxB,EAAd,EAAyB;QAATR,OAAO;IACvB,OAAO,UAACC,IAAD,EAAK;MACR,IAAMC,MAAM,GAAGF,OAAO,CAACG,SAAR,CAAkBF,IAAlB,CAAf;MACA,OAAO,CAACC,MAAM,IAAI,IAAV,IAAkB,CAACF,OAAO,CAACI,KAAR,CAAcF,MAAd,CAApB,KAA8CH,IAAI,CAACE,IAAD,CAAzD;IACH,CAHD;EAIH,CAjH0C;EAmH3CgC,KAAK,EAAL,UACIlC,IADJ,EAEIe,IAFJ,EAGIoB,OAHJ,EAIIC,OAJJ,EAIoB;IAER,UAAM,GAAKD,OAAO,OAAlB;;IAER,IAAI,CAACC,OAAD,IAAYA,OAAO,CAACV,MAAR,KAAmB,CAAnC,EAAsC;MAClC;MACA,OAAOpB,gBAAQ,MAAR,EAAgBN,IAAhB,EAAsBe,IAAtB,EAA4BoB,OAA5B,CAAP;IACH;;IAED,IAAIC,OAAO,CAACV,MAAR,KAAmB,CAAvB,EAA0B;MACtB;MACA,OAAO,UAACxB,IAAD,EAAK;QAAK,aAAM,CAACkC,OAAO,CAAC,CAAD,CAAR,EAAalC,IAAb,CAAN,IAA4BF,IAAI,CAACE,IAAD,CAAhC;MAAsC,CAAvD;IACH;;IAED,OAAO,UAACA,IAAD,EAAK;MAAK,cAAO,CAACS,QAAR,CAAiBT,IAAjB,KAA0BF,IAAI,CAACE,IAAD,CAA9B;IAAoC,CAArD;EACH,CAtI0C;EAwI3CmC,KAAK,EAAEC,kBAAkB,CAAC,WAAD,CAxIkB;EAyI3CC,OAAO,EAAED,kBAAkB,CAAC,WAAD,CAzIgB;EA0I3CE,MAAM,EAAEF,kBAAkB,CAAC,UAAD;AA1IiB,CAAlC;AA6Ib;;;;;;;AAMA,SAASA,kBAAT,CACIG,IADJ,EACgD;EAE5C,OAAO,SAASC,aAAT,CAAuB1C,IAAvB,EAA6BiC,KAA7B,EAAoCxB,EAApC,EAA+C;QAATR,OAAO;IAChD,IAAMgB,IAAI,GAAGhB,OAAO,CAACwC,IAAD,CAApB;;IAEA,IAAI,OAAOxB,IAAP,KAAgB,UAApB,EAAgC;MAC5B,OAAOC,mBAASC,SAAhB;IACH;;IAED,OAAO,SAASqB,MAAT,CAAgBtC,IAAhB,EAAoB;MACvB,OAAOe,IAAI,CAACf,IAAD,CAAJ,IAAcF,IAAI,CAACE,IAAD,CAAzB;IACH,CAFD;EAGH,CAVD;AAWH","names":["getChildFunc","next","adapter","elem","parent","getParent","isTag","exports","contains","text","_a","getText","includes","icontains","itext","toLowerCase","rule","equals","func","boolbase_1","falseFunc","trueFunc","nthChild","siblings","getSiblings","pos","i","length","nthLastChild","nthOfType","currentSibling","getName","nthLastOfType","root","_rule","scope","options","context","hover","dynamicStatePseudo","visited","active","name","dynamicPseudo"],"sources":["pseudo-selectors/filters.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.findAll = exports.existsOne = exports.findOne = exports.findOneChild = exports.find = exports.filter = void 0;\n\nvar domhandler_1 = require(\"domhandler\");\n/**\n * Search a node and its children for nodes passing a test function.\n *\n * @category Querying\n * @param test Function to test nodes on.\n * @param node Node to search. Will be included in the result set if it matches.\n * @param recurse Also consider child nodes.\n * @param limit Maximum number of nodes to return.\n * @returns All nodes passing `test`.\n */\n\n\nfunction filter(test, node, recurse, limit) {\n  if (recurse === void 0) {\n    recurse = true;\n  }\n\n  if (limit === void 0) {\n    limit = Infinity;\n  }\n\n  if (!Array.isArray(node)) node = [node];\n  return find(test, node, recurse, limit);\n}\n\nexports.filter = filter;\n/**\n * Search an array of node and its children for nodes passing a test function.\n *\n * @category Querying\n * @param test Function to test nodes on.\n * @param nodes Array of nodes to search.\n * @param recurse Also consider child nodes.\n * @param limit Maximum number of nodes to return.\n * @returns All nodes passing `test`.\n */\n\nfunction find(test, nodes, recurse, limit) {\n  var result = [];\n\n  for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {\n    var elem = nodes_1[_i];\n\n    if (test(elem)) {\n      result.push(elem);\n      if (--limit <= 0) break;\n    }\n\n    if (recurse && (0, domhandler_1.hasChildren)(elem) && elem.children.length > 0) {\n      var children = find(test, elem.children, recurse, limit);\n      result.push.apply(result, children);\n      limit -= children.length;\n      if (limit <= 0) break;\n    }\n  }\n\n  return result;\n}\n\nexports.find = find;\n/**\n * Finds the first element inside of an array that matches a test function.\n *\n * @category Querying\n * @param test Function to test nodes on.\n * @param nodes Array of nodes to search.\n * @returns The first node in the array that passes `test`.\n * @deprecated Use `Array.prototype.find` directly.\n */\n\nfunction findOneChild(test, nodes) {\n  return nodes.find(test);\n}\n\nexports.findOneChild = findOneChild;\n/**\n * Finds one element in a tree that passes a test.\n *\n * @category Querying\n * @param test Function to test nodes on.\n * @param nodes Array of nodes to search.\n * @param recurse Also consider child nodes.\n * @returns The first child node that passes `test`.\n */\n\nfunction findOne(test, nodes, recurse) {\n  if (recurse === void 0) {\n    recurse = true;\n  }\n\n  var elem = null;\n\n  for (var i = 0; i < nodes.length && !elem; i++) {\n    var checked = nodes[i];\n\n    if (!(0, domhandler_1.isTag)(checked)) {\n      continue;\n    } else if (test(checked)) {\n      elem = checked;\n    } else if (recurse && checked.children.length > 0) {\n      elem = findOne(test, checked.children, true);\n    }\n  }\n\n  return elem;\n}\n\nexports.findOne = findOne;\n/**\n * @category Querying\n * @param test Function to test nodes on.\n * @param nodes Array of nodes to search.\n * @returns Whether a tree of nodes contains at least one node passing the test.\n */\n\nfunction existsOne(test, nodes) {\n  return nodes.some(function (checked) {\n    return (0, domhandler_1.isTag)(checked) && (test(checked) || checked.children.length > 0 && existsOne(test, checked.children));\n  });\n}\n\nexports.existsOne = existsOne;\n/**\n * Search and array of nodes and its children for elements passing a test function.\n *\n * Same as `find`, but limited to elements and with less options, leading to reduced complexity.\n *\n * @category Querying\n * @param test Function to test nodes on.\n * @param nodes Array of nodes to search.\n * @returns All nodes passing `test`.\n */\n\nfunction findAll(test, nodes) {\n  var _a;\n\n  var result = [];\n  var stack = nodes.filter(domhandler_1.isTag);\n  var elem;\n\n  while (elem = stack.shift()) {\n    var children = (_a = elem.children) === null || _a === void 0 ? void 0 : _a.filter(domhandler_1.isTag);\n\n    if (children && children.length > 0) {\n      stack.unshift.apply(stack, children);\n    }\n\n    if (test(elem)) result.push(elem);\n  }\n\n  return result;\n}\n\nexports.findAll = findAll;","map":{"version":3,"mappings":";;;;;;;AAAA;AAEA;;;;;;;;;;;;AAUA,SAAgBA,MAAhB,CACIC,IADJ,EAEIC,IAFJ,EAGIC,OAHJ,EAIIC,KAJJ,EAIoB;EADhB;IAAAD;EAAc;;EACd;IAAAC;EAAgB;;EAEhB,IAAI,CAACC,KAAK,CAACC,OAAN,CAAcJ,IAAd,CAAL,EAA0BA,IAAI,GAAG,CAACA,IAAD,CAAP;EAC1B,OAAOK,IAAI,CAACN,IAAD,EAAOC,IAAP,EAAaC,OAAb,EAAsBC,KAAtB,CAAX;AACH;;AARDI;AAUA;;;;;;;;;;;AAUA,SAAgBD,IAAhB,CACIN,IADJ,EAEIQ,KAFJ,EAGIN,OAHJ,EAIIC,KAJJ,EAIiB;EAEb,IAAMM,MAAM,GAAc,EAA1B;;EAEA,KAAmB,2BAAnB,EAAmBC,mBAAnB,EAAmBA,IAAnB,EAA0B;IAArB,IAAMC,IAAI,cAAV;;IACD,IAAIX,IAAI,CAACW,IAAD,CAAR,EAAgB;MACZF,MAAM,CAACG,IAAP,CAAYD,IAAZ;MACA,IAAI,EAAER,KAAF,IAAW,CAAf,EAAkB;IACrB;;IAED,IAAID,OAAO,IAAI,8BAAYS,IAAZ,CAAX,IAAgCA,IAAI,CAACE,QAAL,CAAcC,MAAd,GAAuB,CAA3D,EAA8D;MAC1D,IAAMD,QAAQ,GAAGP,IAAI,CAACN,IAAD,EAAOW,IAAI,CAACE,QAAZ,EAAsBX,OAAtB,EAA+BC,KAA/B,CAArB;MACAM,MAAM,CAACG,IAAP,CAAWG,KAAX,SAAeF,QAAf;MACAV,KAAK,IAAIU,QAAQ,CAACC,MAAlB;MACA,IAAIX,KAAK,IAAI,CAAb,EAAgB;IACnB;EACJ;;EAED,OAAOM,MAAP;AACH;;AAvBDF;AAyBA;;;;;;;;;;AASA,SAAgBS,YAAhB,CACIhB,IADJ,EAEIQ,KAFJ,EAEc;EAEV,OAAOA,KAAK,CAACF,IAAN,CAAWN,IAAX,CAAP;AACH;;AALDO;AAOA;;;;;;;;;;AASA,SAAgBU,OAAhB,CACIjB,IADJ,EAEIQ,KAFJ,EAGIN,OAHJ,EAGkB;EAAd;IAAAA;EAAc;;EAEd,IAAIS,IAAI,GAAG,IAAX;;EAEA,KAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGV,KAAK,CAACM,MAAV,IAAoB,CAACH,IAArC,EAA2CO,CAAC,EAA5C,EAAgD;IAC5C,IAAMC,OAAO,GAAGX,KAAK,CAACU,CAAD,CAArB;;IACA,IAAI,CAAC,wBAAMC,OAAN,CAAL,EAAqB;MACjB;IACH,CAFD,MAEO,IAAInB,IAAI,CAACmB,OAAD,CAAR,EAAmB;MACtBR,IAAI,GAAGQ,OAAP;IACH,CAFM,MAEA,IAAIjB,OAAO,IAAIiB,OAAO,CAACN,QAAR,CAAiBC,MAAjB,GAA0B,CAAzC,EAA4C;MAC/CH,IAAI,GAAGM,OAAO,CAACjB,IAAD,EAAOmB,OAAO,CAACN,QAAf,EAAyB,IAAzB,CAAd;IACH;EACJ;;EAED,OAAOF,IAAP;AACH;;AAnBDJ;AAqBA;;;;;;;AAMA,SAAgBa,SAAhB,CACIpB,IADJ,EAEIQ,KAFJ,EAEoB;EAEhB,OAAOA,KAAK,CAACa,IAAN,CACH,UAACF,OAAD,EAAQ;IACJ,+BAAMA,OAAN,MACCnB,IAAI,CAACmB,OAAD,CAAJ,IACIA,OAAO,CAACN,QAAR,CAAiBC,MAAjB,GAA0B,CAA1B,IACGM,SAAS,CAACpB,IAAD,EAAOmB,OAAO,CAACN,QAAf,CAHjB;EAG2C,CAL5C,CAAP;AAOH;;AAXDN;AAaA;;;;;;;;;;;AAUA,SAAgBe,OAAhB,CACItB,IADJ,EAEIQ,KAFJ,EAEoB;;;EAEhB,IAAMC,MAAM,GAAc,EAA1B;EACA,IAAMc,KAAK,GAAGf,KAAK,CAACT,MAAN,CAAayB,kBAAb,CAAd;EACA,IAAIb,IAAJ;;EACA,OAAQA,IAAI,GAAGY,KAAK,CAACE,KAAN,EAAf,EAA+B;IAC3B,IAAMZ,QAAQ,GAAG,UAAI,CAACA,QAAL,MAAa,IAAb,IAAaa,aAAb,GAAa,MAAb,GAAaA,GAAE3B,MAAF,CAASyB,kBAAT,CAA9B;;IACA,IAAIX,QAAQ,IAAIA,QAAQ,CAACC,MAAT,GAAkB,CAAlC,EAAqC;MACjCS,KAAK,CAACI,OAAN,CAAaZ,KAAb,QAAiBF,QAAjB;IACH;;IACD,IAAIb,IAAI,CAACW,IAAD,CAAR,EAAgBF,MAAM,CAACG,IAAP,CAAYD,IAAZ;EACnB;;EACD,OAAOF,MAAP;AACH;;AAfDF","names":["filter","test","node","recurse","limit","Array","isArray","find","exports","nodes","result","_i","elem","push","children","length","apply","findOneChild","findOne","i","checked","existsOne","some","findAll","stack","domhandler_1","shift","_a","unshift"],"sources":["querying.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.OpenElementStack = void 0;\n\nconst html_js_1 = require(\"../common/html.js\"); //Element utils\n\n\nconst IMPLICIT_END_TAG_REQUIRED = new Set([html_js_1.TAG_ID.DD, html_js_1.TAG_ID.DT, html_js_1.TAG_ID.LI, html_js_1.TAG_ID.OPTGROUP, html_js_1.TAG_ID.OPTION, html_js_1.TAG_ID.P, html_js_1.TAG_ID.RB, html_js_1.TAG_ID.RP, html_js_1.TAG_ID.RT, html_js_1.TAG_ID.RTC]);\nconst IMPLICIT_END_TAG_REQUIRED_THOROUGHLY = new Set([...IMPLICIT_END_TAG_REQUIRED, html_js_1.TAG_ID.CAPTION, html_js_1.TAG_ID.COLGROUP, html_js_1.TAG_ID.TBODY, html_js_1.TAG_ID.TD, html_js_1.TAG_ID.TFOOT, html_js_1.TAG_ID.TH, html_js_1.TAG_ID.THEAD, html_js_1.TAG_ID.TR]);\nconst SCOPING_ELEMENT_NS = new Map([[html_js_1.TAG_ID.APPLET, html_js_1.NS.HTML], [html_js_1.TAG_ID.CAPTION, html_js_1.NS.HTML], [html_js_1.TAG_ID.HTML, html_js_1.NS.HTML], [html_js_1.TAG_ID.MARQUEE, html_js_1.NS.HTML], [html_js_1.TAG_ID.OBJECT, html_js_1.NS.HTML], [html_js_1.TAG_ID.TABLE, html_js_1.NS.HTML], [html_js_1.TAG_ID.TD, html_js_1.NS.HTML], [html_js_1.TAG_ID.TEMPLATE, html_js_1.NS.HTML], [html_js_1.TAG_ID.TH, html_js_1.NS.HTML], [html_js_1.TAG_ID.ANNOTATION_XML, html_js_1.NS.MATHML], [html_js_1.TAG_ID.MI, html_js_1.NS.MATHML], [html_js_1.TAG_ID.MN, html_js_1.NS.MATHML], [html_js_1.TAG_ID.MO, html_js_1.NS.MATHML], [html_js_1.TAG_ID.MS, html_js_1.NS.MATHML], [html_js_1.TAG_ID.MTEXT, html_js_1.NS.MATHML], [html_js_1.TAG_ID.DESC, html_js_1.NS.SVG], [html_js_1.TAG_ID.FOREIGN_OBJECT, html_js_1.NS.SVG], [html_js_1.TAG_ID.TITLE, html_js_1.NS.SVG]]);\nconst NAMED_HEADERS = [html_js_1.TAG_ID.H1, html_js_1.TAG_ID.H2, html_js_1.TAG_ID.H3, html_js_1.TAG_ID.H4, html_js_1.TAG_ID.H5, html_js_1.TAG_ID.H6];\nconst TABLE_ROW_CONTEXT = [html_js_1.TAG_ID.TR, html_js_1.TAG_ID.TEMPLATE, html_js_1.TAG_ID.HTML];\nconst TABLE_BODY_CONTEXT = [html_js_1.TAG_ID.TBODY, html_js_1.TAG_ID.TFOOT, html_js_1.TAG_ID.THEAD, html_js_1.TAG_ID.TEMPLATE, html_js_1.TAG_ID.HTML];\nconst TABLE_CONTEXT = [html_js_1.TAG_ID.TABLE, html_js_1.TAG_ID.TEMPLATE, html_js_1.TAG_ID.HTML];\nconst TABLE_CELLS = [html_js_1.TAG_ID.TD, html_js_1.TAG_ID.TH]; //Stack of open elements\n\nclass OpenElementStack {\n  constructor(document, treeAdapter, handler) {\n    this.treeAdapter = treeAdapter;\n    this.handler = handler;\n    this.items = [];\n    this.tagIDs = [];\n    this.stackTop = -1;\n    this.tmplCount = 0;\n    this.currentTagId = html_js_1.TAG_ID.UNKNOWN;\n    this.current = document;\n  }\n\n  get currentTmplContentOrNode() {\n    return this._isInTemplate() ? this.treeAdapter.getTemplateContent(this.current) : this.current;\n  } //Index of element\n\n\n  _indexOf(element) {\n    return this.items.lastIndexOf(element, this.stackTop);\n  } //Update current element\n\n\n  _isInTemplate() {\n    return this.currentTagId === html_js_1.TAG_ID.TEMPLATE && this.treeAdapter.getNamespaceURI(this.current) === html_js_1.NS.HTML;\n  }\n\n  _updateCurrentElement() {\n    this.current = this.items[this.stackTop];\n    this.currentTagId = this.tagIDs[this.stackTop];\n  } //Mutations\n\n\n  push(element, tagID) {\n    this.stackTop++;\n    this.items[this.stackTop] = element;\n    this.current = element;\n    this.tagIDs[this.stackTop] = tagID;\n    this.currentTagId = tagID;\n\n    if (this._isInTemplate()) {\n      this.tmplCount++;\n    }\n\n    this.handler.onItemPush(element, tagID, true);\n  }\n\n  pop() {\n    const popped = this.current;\n\n    if (this.tmplCount > 0 && this._isInTemplate()) {\n      this.tmplCount--;\n    }\n\n    this.stackTop--;\n\n    this._updateCurrentElement();\n\n    this.handler.onItemPop(popped, true);\n  }\n\n  replace(oldElement, newElement) {\n    const idx = this._indexOf(oldElement);\n\n    this.items[idx] = newElement;\n\n    if (idx === this.stackTop) {\n      this.current = newElement;\n    }\n  }\n\n  insertAfter(referenceElement, newElement, newElementID) {\n    const insertionIdx = this._indexOf(referenceElement) + 1;\n    this.items.splice(insertionIdx, 0, newElement);\n    this.tagIDs.splice(insertionIdx, 0, newElementID);\n    this.stackTop++;\n\n    if (insertionIdx === this.stackTop) {\n      this._updateCurrentElement();\n    }\n\n    this.handler.onItemPush(this.current, this.currentTagId, insertionIdx === this.stackTop);\n  }\n\n  popUntilTagNamePopped(tagName) {\n    let targetIdx = this.stackTop + 1;\n\n    do {\n      targetIdx = this.tagIDs.lastIndexOf(tagName, targetIdx - 1);\n    } while (targetIdx > 0 && this.treeAdapter.getNamespaceURI(this.items[targetIdx]) !== html_js_1.NS.HTML);\n\n    this.shortenToLength(targetIdx < 0 ? 0 : targetIdx);\n  }\n\n  shortenToLength(idx) {\n    while (this.stackTop >= idx) {\n      const popped = this.current;\n\n      if (this.tmplCount > 0 && this._isInTemplate()) {\n        this.tmplCount -= 1;\n      }\n\n      this.stackTop--;\n\n      this._updateCurrentElement();\n\n      this.handler.onItemPop(popped, this.stackTop < idx);\n    }\n  }\n\n  popUntilElementPopped(element) {\n    const idx = this._indexOf(element);\n\n    this.shortenToLength(idx < 0 ? 0 : idx);\n  }\n\n  popUntilPopped(tagNames, targetNS) {\n    const idx = this._indexOfTagNames(tagNames, targetNS);\n\n    this.shortenToLength(idx < 0 ? 0 : idx);\n  }\n\n  popUntilNumberedHeaderPopped() {\n    this.popUntilPopped(NAMED_HEADERS, html_js_1.NS.HTML);\n  }\n\n  popUntilTableCellPopped() {\n    this.popUntilPopped(TABLE_CELLS, html_js_1.NS.HTML);\n  }\n\n  popAllUpToHtmlElement() {\n    //NOTE: here we assume that the root <html> element is always first in the open element stack, so\n    //we perform this fast stack clean up.\n    this.tmplCount = 0;\n    this.shortenToLength(1);\n  }\n\n  _indexOfTagNames(tagNames, namespace) {\n    for (let i = this.stackTop; i >= 0; i--) {\n      if (tagNames.includes(this.tagIDs[i]) && this.treeAdapter.getNamespaceURI(this.items[i]) === namespace) {\n        return i;\n      }\n    }\n\n    return -1;\n  }\n\n  clearBackTo(tagNames, targetNS) {\n    const idx = this._indexOfTagNames(tagNames, targetNS);\n\n    this.shortenToLength(idx + 1);\n  }\n\n  clearBackToTableContext() {\n    this.clearBackTo(TABLE_CONTEXT, html_js_1.NS.HTML);\n  }\n\n  clearBackToTableBodyContext() {\n    this.clearBackTo(TABLE_BODY_CONTEXT, html_js_1.NS.HTML);\n  }\n\n  clearBackToTableRowContext() {\n    this.clearBackTo(TABLE_ROW_CONTEXT, html_js_1.NS.HTML);\n  }\n\n  remove(element) {\n    const idx = this._indexOf(element);\n\n    if (idx >= 0) {\n      if (idx === this.stackTop) {\n        this.pop();\n      } else {\n        this.items.splice(idx, 1);\n        this.tagIDs.splice(idx, 1);\n        this.stackTop--;\n\n        this._updateCurrentElement();\n\n        this.handler.onItemPop(element, false);\n      }\n    }\n  } //Search\n\n\n  tryPeekProperlyNestedBodyElement() {\n    //Properly nested <body> element (should be second element in stack).\n    return this.stackTop >= 1 && this.tagIDs[1] === html_js_1.TAG_ID.BODY ? this.items[1] : null;\n  }\n\n  contains(element) {\n    return this._indexOf(element) > -1;\n  }\n\n  getCommonAncestor(element) {\n    const elementIdx = this._indexOf(element) - 1;\n    return elementIdx >= 0 ? this.items[elementIdx] : null;\n  }\n\n  isRootHtmlElementCurrent() {\n    return this.stackTop === 0 && this.tagIDs[0] === html_js_1.TAG_ID.HTML;\n  } //Element in scope\n\n\n  hasInScope(tagName) {\n    for (let i = this.stackTop; i >= 0; i--) {\n      const tn = this.tagIDs[i];\n      const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n\n      if (tn === tagName && ns === html_js_1.NS.HTML) {\n        return true;\n      }\n\n      if (SCOPING_ELEMENT_NS.get(tn) === ns) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  hasNumberedHeaderInScope() {\n    for (let i = this.stackTop; i >= 0; i--) {\n      const tn = this.tagIDs[i];\n      const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n\n      if ((0, html_js_1.isNumberedHeader)(tn) && ns === html_js_1.NS.HTML) {\n        return true;\n      }\n\n      if (SCOPING_ELEMENT_NS.get(tn) === ns) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  hasInListItemScope(tagName) {\n    for (let i = this.stackTop; i >= 0; i--) {\n      const tn = this.tagIDs[i];\n      const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n\n      if (tn === tagName && ns === html_js_1.NS.HTML) {\n        return true;\n      }\n\n      if ((tn === html_js_1.TAG_ID.UL || tn === html_js_1.TAG_ID.OL) && ns === html_js_1.NS.HTML || SCOPING_ELEMENT_NS.get(tn) === ns) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  hasInButtonScope(tagName) {\n    for (let i = this.stackTop; i >= 0; i--) {\n      const tn = this.tagIDs[i];\n      const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n\n      if (tn === tagName && ns === html_js_1.NS.HTML) {\n        return true;\n      }\n\n      if (tn === html_js_1.TAG_ID.BUTTON && ns === html_js_1.NS.HTML || SCOPING_ELEMENT_NS.get(tn) === ns) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  hasInTableScope(tagName) {\n    for (let i = this.stackTop; i >= 0; i--) {\n      const tn = this.tagIDs[i];\n      const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n\n      if (ns !== html_js_1.NS.HTML) {\n        continue;\n      }\n\n      if (tn === tagName) {\n        return true;\n      }\n\n      if (tn === html_js_1.TAG_ID.TABLE || tn === html_js_1.TAG_ID.TEMPLATE || tn === html_js_1.TAG_ID.HTML) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  hasTableBodyContextInTableScope() {\n    for (let i = this.stackTop; i >= 0; i--) {\n      const tn = this.tagIDs[i];\n      const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n\n      if (ns !== html_js_1.NS.HTML) {\n        continue;\n      }\n\n      if (tn === html_js_1.TAG_ID.TBODY || tn === html_js_1.TAG_ID.THEAD || tn === html_js_1.TAG_ID.TFOOT) {\n        return true;\n      }\n\n      if (tn === html_js_1.TAG_ID.TABLE || tn === html_js_1.TAG_ID.HTML) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  hasInSelectScope(tagName) {\n    for (let i = this.stackTop; i >= 0; i--) {\n      const tn = this.tagIDs[i];\n      const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n\n      if (ns !== html_js_1.NS.HTML) {\n        continue;\n      }\n\n      if (tn === tagName) {\n        return true;\n      }\n\n      if (tn !== html_js_1.TAG_ID.OPTION && tn !== html_js_1.TAG_ID.OPTGROUP) {\n        return false;\n      }\n    }\n\n    return true;\n  } //Implied end tags\n\n\n  generateImpliedEndTags() {\n    while (IMPLICIT_END_TAG_REQUIRED.has(this.currentTagId)) {\n      this.pop();\n    }\n  }\n\n  generateImpliedEndTagsThoroughly() {\n    while (IMPLICIT_END_TAG_REQUIRED_THOROUGHLY.has(this.currentTagId)) {\n      this.pop();\n    }\n  }\n\n  generateImpliedEndTagsWithExclusion(exclusionId) {\n    while (this.currentTagId !== exclusionId && IMPLICIT_END_TAG_REQUIRED_THOROUGHLY.has(this.currentTagId)) {\n      this.pop();\n    }\n  }\n\n}\n\nexports.OpenElementStack = OpenElementStack;","map":{"version":3,"names":["Object","defineProperty","exports","value","OpenElementStack","html_js_1","require","IMPLICIT_END_TAG_REQUIRED","Set","TAG_ID","DD","DT","LI","OPTGROUP","OPTION","P","RB","RP","RT","RTC","IMPLICIT_END_TAG_REQUIRED_THOROUGHLY","CAPTION","COLGROUP","TBODY","TD","TFOOT","TH","THEAD","TR","SCOPING_ELEMENT_NS","Map","APPLET","NS","HTML","MARQUEE","OBJECT","TABLE","TEMPLATE","ANNOTATION_XML","MATHML","MI","MN","MO","MS","MTEXT","DESC","SVG","FOREIGN_OBJECT","TITLE","NAMED_HEADERS","H1","H2","H3","H4","H5","H6","TABLE_ROW_CONTEXT","TABLE_BODY_CONTEXT","TABLE_CONTEXT","TABLE_CELLS","constructor","document","treeAdapter","handler","items","tagIDs","stackTop","tmplCount","currentTagId","UNKNOWN","current","currentTmplContentOrNode","_isInTemplate","getTemplateContent","_indexOf","element","lastIndexOf","getNamespaceURI","_updateCurrentElement","push","tagID","onItemPush","pop","popped","onItemPop","replace","oldElement","newElement","idx","insertAfter","referenceElement","newElementID","insertionIdx","splice","popUntilTagNamePopped","tagName","targetIdx","shortenToLength","popUntilElementPopped","popUntilPopped","tagNames","targetNS","_indexOfTagNames","popUntilNumberedHeaderPopped","popUntilTableCellPopped","popAllUpToHtmlElement","namespace","i","includes","clearBackTo","clearBackToTableContext","clearBackToTableBodyContext","clearBackToTableRowContext","remove","tryPeekProperlyNestedBodyElement","BODY","contains","getCommonAncestor","elementIdx","isRootHtmlElementCurrent","hasInScope","tn","ns","get","hasNumberedHeaderInScope","isNumberedHeader","hasInListItemScope","UL","OL","hasInButtonScope","BUTTON","hasInTableScope","hasTableBodyContextInTableScope","hasInSelectScope","generateImpliedEndTags","has","generateImpliedEndTagsThoroughly","generateImpliedEndTagsWithExclusion","exclusionId"],"sources":["/Users/tranminhtrung/Desktop/learn_web3/gamble/node_modules/cheerio/node_modules/parse5/dist/cjs/parser/open-element-stack.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.OpenElementStack = void 0;\nconst html_js_1 = require(\"../common/html.js\");\n//Element utils\nconst IMPLICIT_END_TAG_REQUIRED = new Set([html_js_1.TAG_ID.DD, html_js_1.TAG_ID.DT, html_js_1.TAG_ID.LI, html_js_1.TAG_ID.OPTGROUP, html_js_1.TAG_ID.OPTION, html_js_1.TAG_ID.P, html_js_1.TAG_ID.RB, html_js_1.TAG_ID.RP, html_js_1.TAG_ID.RT, html_js_1.TAG_ID.RTC]);\nconst IMPLICIT_END_TAG_REQUIRED_THOROUGHLY = new Set([\n    ...IMPLICIT_END_TAG_REQUIRED,\n    html_js_1.TAG_ID.CAPTION,\n    html_js_1.TAG_ID.COLGROUP,\n    html_js_1.TAG_ID.TBODY,\n    html_js_1.TAG_ID.TD,\n    html_js_1.TAG_ID.TFOOT,\n    html_js_1.TAG_ID.TH,\n    html_js_1.TAG_ID.THEAD,\n    html_js_1.TAG_ID.TR,\n]);\nconst SCOPING_ELEMENT_NS = new Map([\n    [html_js_1.TAG_ID.APPLET, html_js_1.NS.HTML],\n    [html_js_1.TAG_ID.CAPTION, html_js_1.NS.HTML],\n    [html_js_1.TAG_ID.HTML, html_js_1.NS.HTML],\n    [html_js_1.TAG_ID.MARQUEE, html_js_1.NS.HTML],\n    [html_js_1.TAG_ID.OBJECT, html_js_1.NS.HTML],\n    [html_js_1.TAG_ID.TABLE, html_js_1.NS.HTML],\n    [html_js_1.TAG_ID.TD, html_js_1.NS.HTML],\n    [html_js_1.TAG_ID.TEMPLATE, html_js_1.NS.HTML],\n    [html_js_1.TAG_ID.TH, html_js_1.NS.HTML],\n    [html_js_1.TAG_ID.ANNOTATION_XML, html_js_1.NS.MATHML],\n    [html_js_1.TAG_ID.MI, html_js_1.NS.MATHML],\n    [html_js_1.TAG_ID.MN, html_js_1.NS.MATHML],\n    [html_js_1.TAG_ID.MO, html_js_1.NS.MATHML],\n    [html_js_1.TAG_ID.MS, html_js_1.NS.MATHML],\n    [html_js_1.TAG_ID.MTEXT, html_js_1.NS.MATHML],\n    [html_js_1.TAG_ID.DESC, html_js_1.NS.SVG],\n    [html_js_1.TAG_ID.FOREIGN_OBJECT, html_js_1.NS.SVG],\n    [html_js_1.TAG_ID.TITLE, html_js_1.NS.SVG],\n]);\nconst NAMED_HEADERS = [html_js_1.TAG_ID.H1, html_js_1.TAG_ID.H2, html_js_1.TAG_ID.H3, html_js_1.TAG_ID.H4, html_js_1.TAG_ID.H5, html_js_1.TAG_ID.H6];\nconst TABLE_ROW_CONTEXT = [html_js_1.TAG_ID.TR, html_js_1.TAG_ID.TEMPLATE, html_js_1.TAG_ID.HTML];\nconst TABLE_BODY_CONTEXT = [html_js_1.TAG_ID.TBODY, html_js_1.TAG_ID.TFOOT, html_js_1.TAG_ID.THEAD, html_js_1.TAG_ID.TEMPLATE, html_js_1.TAG_ID.HTML];\nconst TABLE_CONTEXT = [html_js_1.TAG_ID.TABLE, html_js_1.TAG_ID.TEMPLATE, html_js_1.TAG_ID.HTML];\nconst TABLE_CELLS = [html_js_1.TAG_ID.TD, html_js_1.TAG_ID.TH];\n//Stack of open elements\nclass OpenElementStack {\n    constructor(document, treeAdapter, handler) {\n        this.treeAdapter = treeAdapter;\n        this.handler = handler;\n        this.items = [];\n        this.tagIDs = [];\n        this.stackTop = -1;\n        this.tmplCount = 0;\n        this.currentTagId = html_js_1.TAG_ID.UNKNOWN;\n        this.current = document;\n    }\n    get currentTmplContentOrNode() {\n        return this._isInTemplate() ? this.treeAdapter.getTemplateContent(this.current) : this.current;\n    }\n    //Index of element\n    _indexOf(element) {\n        return this.items.lastIndexOf(element, this.stackTop);\n    }\n    //Update current element\n    _isInTemplate() {\n        return this.currentTagId === html_js_1.TAG_ID.TEMPLATE && this.treeAdapter.getNamespaceURI(this.current) === html_js_1.NS.HTML;\n    }\n    _updateCurrentElement() {\n        this.current = this.items[this.stackTop];\n        this.currentTagId = this.tagIDs[this.stackTop];\n    }\n    //Mutations\n    push(element, tagID) {\n        this.stackTop++;\n        this.items[this.stackTop] = element;\n        this.current = element;\n        this.tagIDs[this.stackTop] = tagID;\n        this.currentTagId = tagID;\n        if (this._isInTemplate()) {\n            this.tmplCount++;\n        }\n        this.handler.onItemPush(element, tagID, true);\n    }\n    pop() {\n        const popped = this.current;\n        if (this.tmplCount > 0 && this._isInTemplate()) {\n            this.tmplCount--;\n        }\n        this.stackTop--;\n        this._updateCurrentElement();\n        this.handler.onItemPop(popped, true);\n    }\n    replace(oldElement, newElement) {\n        const idx = this._indexOf(oldElement);\n        this.items[idx] = newElement;\n        if (idx === this.stackTop) {\n            this.current = newElement;\n        }\n    }\n    insertAfter(referenceElement, newElement, newElementID) {\n        const insertionIdx = this._indexOf(referenceElement) + 1;\n        this.items.splice(insertionIdx, 0, newElement);\n        this.tagIDs.splice(insertionIdx, 0, newElementID);\n        this.stackTop++;\n        if (insertionIdx === this.stackTop) {\n            this._updateCurrentElement();\n        }\n        this.handler.onItemPush(this.current, this.currentTagId, insertionIdx === this.stackTop);\n    }\n    popUntilTagNamePopped(tagName) {\n        let targetIdx = this.stackTop + 1;\n        do {\n            targetIdx = this.tagIDs.lastIndexOf(tagName, targetIdx - 1);\n        } while (targetIdx > 0 && this.treeAdapter.getNamespaceURI(this.items[targetIdx]) !== html_js_1.NS.HTML);\n        this.shortenToLength(targetIdx < 0 ? 0 : targetIdx);\n    }\n    shortenToLength(idx) {\n        while (this.stackTop >= idx) {\n            const popped = this.current;\n            if (this.tmplCount > 0 && this._isInTemplate()) {\n                this.tmplCount -= 1;\n            }\n            this.stackTop--;\n            this._updateCurrentElement();\n            this.handler.onItemPop(popped, this.stackTop < idx);\n        }\n    }\n    popUntilElementPopped(element) {\n        const idx = this._indexOf(element);\n        this.shortenToLength(idx < 0 ? 0 : idx);\n    }\n    popUntilPopped(tagNames, targetNS) {\n        const idx = this._indexOfTagNames(tagNames, targetNS);\n        this.shortenToLength(idx < 0 ? 0 : idx);\n    }\n    popUntilNumberedHeaderPopped() {\n        this.popUntilPopped(NAMED_HEADERS, html_js_1.NS.HTML);\n    }\n    popUntilTableCellPopped() {\n        this.popUntilPopped(TABLE_CELLS, html_js_1.NS.HTML);\n    }\n    popAllUpToHtmlElement() {\n        //NOTE: here we assume that the root <html> element is always first in the open element stack, so\n        //we perform this fast stack clean up.\n        this.tmplCount = 0;\n        this.shortenToLength(1);\n    }\n    _indexOfTagNames(tagNames, namespace) {\n        for (let i = this.stackTop; i >= 0; i--) {\n            if (tagNames.includes(this.tagIDs[i]) && this.treeAdapter.getNamespaceURI(this.items[i]) === namespace) {\n                return i;\n            }\n        }\n        return -1;\n    }\n    clearBackTo(tagNames, targetNS) {\n        const idx = this._indexOfTagNames(tagNames, targetNS);\n        this.shortenToLength(idx + 1);\n    }\n    clearBackToTableContext() {\n        this.clearBackTo(TABLE_CONTEXT, html_js_1.NS.HTML);\n    }\n    clearBackToTableBodyContext() {\n        this.clearBackTo(TABLE_BODY_CONTEXT, html_js_1.NS.HTML);\n    }\n    clearBackToTableRowContext() {\n        this.clearBackTo(TABLE_ROW_CONTEXT, html_js_1.NS.HTML);\n    }\n    remove(element) {\n        const idx = this._indexOf(element);\n        if (idx >= 0) {\n            if (idx === this.stackTop) {\n                this.pop();\n            }\n            else {\n                this.items.splice(idx, 1);\n                this.tagIDs.splice(idx, 1);\n                this.stackTop--;\n                this._updateCurrentElement();\n                this.handler.onItemPop(element, false);\n            }\n        }\n    }\n    //Search\n    tryPeekProperlyNestedBodyElement() {\n        //Properly nested <body> element (should be second element in stack).\n        return this.stackTop >= 1 && this.tagIDs[1] === html_js_1.TAG_ID.BODY ? this.items[1] : null;\n    }\n    contains(element) {\n        return this._indexOf(element) > -1;\n    }\n    getCommonAncestor(element) {\n        const elementIdx = this._indexOf(element) - 1;\n        return elementIdx >= 0 ? this.items[elementIdx] : null;\n    }\n    isRootHtmlElementCurrent() {\n        return this.stackTop === 0 && this.tagIDs[0] === html_js_1.TAG_ID.HTML;\n    }\n    //Element in scope\n    hasInScope(tagName) {\n        for (let i = this.stackTop; i >= 0; i--) {\n            const tn = this.tagIDs[i];\n            const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n            if (tn === tagName && ns === html_js_1.NS.HTML) {\n                return true;\n            }\n            if (SCOPING_ELEMENT_NS.get(tn) === ns) {\n                return false;\n            }\n        }\n        return true;\n    }\n    hasNumberedHeaderInScope() {\n        for (let i = this.stackTop; i >= 0; i--) {\n            const tn = this.tagIDs[i];\n            const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n            if ((0, html_js_1.isNumberedHeader)(tn) && ns === html_js_1.NS.HTML) {\n                return true;\n            }\n            if (SCOPING_ELEMENT_NS.get(tn) === ns) {\n                return false;\n            }\n        }\n        return true;\n    }\n    hasInListItemScope(tagName) {\n        for (let i = this.stackTop; i >= 0; i--) {\n            const tn = this.tagIDs[i];\n            const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n            if (tn === tagName && ns === html_js_1.NS.HTML) {\n                return true;\n            }\n            if (((tn === html_js_1.TAG_ID.UL || tn === html_js_1.TAG_ID.OL) && ns === html_js_1.NS.HTML) || SCOPING_ELEMENT_NS.get(tn) === ns) {\n                return false;\n            }\n        }\n        return true;\n    }\n    hasInButtonScope(tagName) {\n        for (let i = this.stackTop; i >= 0; i--) {\n            const tn = this.tagIDs[i];\n            const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n            if (tn === tagName && ns === html_js_1.NS.HTML) {\n                return true;\n            }\n            if ((tn === html_js_1.TAG_ID.BUTTON && ns === html_js_1.NS.HTML) || SCOPING_ELEMENT_NS.get(tn) === ns) {\n                return false;\n            }\n        }\n        return true;\n    }\n    hasInTableScope(tagName) {\n        for (let i = this.stackTop; i >= 0; i--) {\n            const tn = this.tagIDs[i];\n            const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n            if (ns !== html_js_1.NS.HTML) {\n                continue;\n            }\n            if (tn === tagName) {\n                return true;\n            }\n            if (tn === html_js_1.TAG_ID.TABLE || tn === html_js_1.TAG_ID.TEMPLATE || tn === html_js_1.TAG_ID.HTML) {\n                return false;\n            }\n        }\n        return true;\n    }\n    hasTableBodyContextInTableScope() {\n        for (let i = this.stackTop; i >= 0; i--) {\n            const tn = this.tagIDs[i];\n            const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n            if (ns !== html_js_1.NS.HTML) {\n                continue;\n            }\n            if (tn === html_js_1.TAG_ID.TBODY || tn === html_js_1.TAG_ID.THEAD || tn === html_js_1.TAG_ID.TFOOT) {\n                return true;\n            }\n            if (tn === html_js_1.TAG_ID.TABLE || tn === html_js_1.TAG_ID.HTML) {\n                return false;\n            }\n        }\n        return true;\n    }\n    hasInSelectScope(tagName) {\n        for (let i = this.stackTop; i >= 0; i--) {\n            const tn = this.tagIDs[i];\n            const ns = this.treeAdapter.getNamespaceURI(this.items[i]);\n            if (ns !== html_js_1.NS.HTML) {\n                continue;\n            }\n            if (tn === tagName) {\n                return true;\n            }\n            if (tn !== html_js_1.TAG_ID.OPTION && tn !== html_js_1.TAG_ID.OPTGROUP) {\n                return false;\n            }\n        }\n        return true;\n    }\n    //Implied end tags\n    generateImpliedEndTags() {\n        while (IMPLICIT_END_TAG_REQUIRED.has(this.currentTagId)) {\n            this.pop();\n        }\n    }\n    generateImpliedEndTagsThoroughly() {\n        while (IMPLICIT_END_TAG_REQUIRED_THOROUGHLY.has(this.currentTagId)) {\n            this.pop();\n        }\n    }\n    generateImpliedEndTagsWithExclusion(exclusionId) {\n        while (this.currentTagId !== exclusionId && IMPLICIT_END_TAG_REQUIRED_THOROUGHLY.has(this.currentTagId)) {\n            this.pop();\n        }\n    }\n}\nexports.OpenElementStack = OpenElementStack;\n//# sourceMappingURL=open-element-stack.js.map"],"mappings":"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"},"metadata":{},"sourceType":"script"}